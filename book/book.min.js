/*! jQuery Browser - v0.1.0 - 3/23/2012
* https://github.com/jquery/jquery-browser
* Copyright (c) 2012 John Resig; Licensed MIT */
/*
	THIS IS A STRIPPED VERSION OF THE ORIGINAL LIBRARY!
*/
/* Modernizr 2.5.3 (Custom Build) | MIT & BSD
 * Build: http://www.modernizr.com/download/#-csstransforms3d-prefixed-teststyles-testprop-testallprops-prefixes-domprefixes
 */
/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
/*
 * @name wowBook
 *
 * @author Marcio Aguiar
 * @version 1.0
 * @requires jQuery v1.7.0
 *
 * Copyright 2010 Marcio Aguiar. All rights reserved.
 *
 * To use this file you must to buy a license at http://codecanyon.net/user/maguiar01/portfolio
 *
 * Date: Wed Dec 8 10:05:49 2010 -0200
 */
(function(d){if(!d.browser){var l;l=navigator.userAgent||"";d.uaMatch=function(d){d=d.toLowerCase();d=/(chrome)[ \/]([\w.]+)/.exec(d)||/(webkit)[ \/]([\w.]+)/.exec(d)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(d)||/(msie) ([\w.]+)/.exec(d)||0>d.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(d)||[];return{browser:d[1]||"",version:d[2]||"0"}};l=d.uaMatch(l);d.browser={};l.browser&&(d.browser[l.browser]=!0,d.browser.version=l.version);d.browser.webkit&&(d.browser.safari=!0)}})(jQuery);
jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{easeOutCubic:function(d,l,u,r,t){return r*((l=l/t-1)*l*l+1)+u},easeOutExpo:function(d,l,u,r,t){return l==t?u+r:r*(-Math.pow(2,-10*l/t)+1)+u}});
window.Modernizr=function(d,l,u){function r(a,c){for(var f in a)if(b[a[f]]!==u)return"pfx"==c?a[f]:!0;return!1}function t(a,b,e){var d=a.charAt(0).toUpperCase()+a.substr(1),g=(a+" "+c.join(d+" ")+d).split(" ");if("string"===typeof b||"undefined"===typeof b)b=r(g,b);else a:{g=(a+" "+f.join(d+" ")+d).split(" "),a=g;for(var h in a)if(d=b[a[h]],d!==u){b=!1===e?a[h]:"function"===typeof d?d.bind(e||b):d;break a}b=!1}return b}var n={},q=l.documentElement,a=l.createElement("modernizr"),b=a.style;d=" -webkit- -moz- -o- -ms- ".split(" ");
var c=["Webkit","Moz","O","ms"],f=["webkit","moz","o","ms"],a={},e=[],g=e.slice,h,k=function(a,c,b,f){var e,d,g,h=l.createElement("div"),k=l.body,m=k?k:l.createElement("body");if(parseInt(b,10))for(;b--;)g=l.createElement("div"),g.id=f?f[b]:"modernizr"+(b+1),h.appendChild(g);return e=["&#173;<style>",a,"</style>"].join(""),h.id="modernizr",(k?h:m).innerHTML+=e,m.appendChild(h),k||(m.style.background="",q.appendChild(m)),d=c(h,a),k?h.parentNode.removeChild(h):m.parentNode.removeChild(m),!!d},m={}.hasOwnProperty,
z;"undefined"===typeof m||"undefined"===typeof m.call?z=function(a,b){return b in a&&"undefined"===typeof a.constructor.prototype[b]}:z=function(a,b){return m.call(a,b)};Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=g.call(arguments,1),f=function(){if(this instanceof f){var e=function(){};e.prototype=b.prototype;var e=new e,d=b.apply(e,c.concat(g.call(arguments)));return Object(d)===d?d:e}return b.apply(a,c.concat(g.call(arguments)))};
return f});(function(a,b){var c=a.join(""),f=b.length;k(c,function(a,b){for(var c=a.childNodes,e={};f--;)e[c[f].id]=c[f];n.csstransforms3d=9===(e.csstransforms3d&&e.csstransforms3d.offsetLeft)&&3===e.csstransforms3d.offsetHeight},f,b)})([,["@media (",d.join("transform-3d),("),"modernizr){#csstransforms3d{left:9px;position:absolute;height:3px;}}"].join("")],[,"csstransforms3d"]);a.csstransforms3d=function(){var a=!!t("perspective");return a&&"webkitPerspective"in q.style&&(a=n.csstransforms3d),a};
for(var B in a)z(a,B)&&(h=B.toLowerCase(),n[h]=a[B](),e.push((n[h]?"":"no-")+h));b.cssText="";return a=null,n._version="2.5.3",n._prefixes=d,n._domPrefixes=f,n._cssomPrefixes=c,n.testProp=function(a){return r([a])},n.testAllProps=t,n.testStyles=k,n.prefixed=function(a,b,c){return b?t(a,b,c):t(a,"pfx")},n}(this,this.document);
(function(d,l,u){function r(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}"$:nomunge";var t="hashchange",n=document,q,a=d.event.special,b=n.documentMode,c="on"+t in l&&(b===u||7<b);d.fn[t]=function(a){return a?this.bind(t,a):this.trigger(t)};d.fn[t].delay=50;a[t]=d.extend(a[t],{setup:function(){if(c)return!1;d(q.start)},teardown:function(){if(c)return!1;d(q.stop)}});q=function(){function a(){var b=r(),c=z(h);b!==h?(m(h=b,c),d(l).trigger(t)):c!==h&&(location.href=location.href.replace(/#.*/,
"")+c);g=setTimeout(a,d.fn[t].delay)}var b={},g,h=r(),k=function(a){return a},m=k,z=k;b.start=function(){g||a()};b.stop=function(){g&&clearTimeout(g);g=u};d.browser.msie&&!c&&function(){var c,g;b.start=function(){c||(g=(g=d.fn[t].src)&&g+r(),c=d('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){g||m(r());a()}).attr("src",g||"javascript:0").insertAfter("body")[0].contentWindow,n.onpropertychange=function(){try{"title"===event.propertyName&&(c.document.title=n.title)}catch(a){}})};
b.stop=k;z=function(){return r(c.location.href)};m=function(a,b){var f=c.document,e=d.fn[t].domain;a!==b&&(f.title=n.title,f.open(),e&&f.write('<script>document.domain="'+e+'"\x3c/script>'),f.close(),c.location.hash=a)}}();return b}()})(jQuery,this);
(function(d){function l(a,b){a=d(a);var c=this;this.elem=a;this.id=a.attr("id");this.pages=[];this.opts=b;this.currentPage=null;this.pageWidth=b.width/2;this.pageHeight=b.height;this.transparentPages=b.transparentPages=!1;this.startPage=b.startPage;this.onShowPage=b.onShowPage;this.slideShow=b.slideShow;this.slideShowDelay=b.slideShowDelay;this.pauseOnHover=b.pauseOnHover;this.turnPageDuration=b.turnPageDuration;this.foldGradient=b.foldGradient;this.foldGradientThreshold=b.foldGradientThreshold;this.shadows=
b.shadows;this.shadowThreshold=b.shadowThreshold;this.clipBoundaries=b.clipBoundaries;this.zoomLevel=1;this.zoomMax=b.zoomMax;this.zoomMin=b.zoomMin;this.zoomBoundingBox=b.zoomBoundingBox;this.zoomStep=b.zoomStep;this.onZoom=b.onZoom;this.mouseWheel=b.mouseWheel;this.flipSound=b.flipSound;this.centeredWhenClosed=b.centeredWhenClosed;this.sectionDefinition=b.sections;this.rtl=b.rtl;d.wowBook.support.filters="filters"in a[0];a.addClass("wowbook");"static"===a.css("position")&&a.css("position","relative");
var f=a.children(),e=this.pagesContainer=this.origin=d("<div class='wowbook-origin'></div>").css({position:"absolute"}).appendTo(a);c.bookShadow=d("<div class='wowbook-book-shadow'></div>").appendTo(a).css({top:0,position:"absolute",display:"none",zIndex:0});this.insertPages(f,!0);e.append("<div class='wowbook-shadow-clipper'><div class='wowbook-shadow-container'><div class='wowbook-shadow-internal'></div></div></div>");c.shadowContainer=d(".wowbook-shadow-container",e);c.internalShadow=d(".wowbook-shadow-internal",
e);c.shadowClipper=d(".wowbook-shadow-clipper",e).css({display:"none"});c.foldShadow=d("<div class='wowbook-shadow-fold'></div>").appendTo(c.shadowContainer);c.foldGradientContainer=d("<div class='wowbook-fold-gradient-container'></div>").appendTo(c.shadowContainer);c.foldGradientElem=d("<div class='wowbook-fold-gradient'></div>").appendTo(c.foldGradientContainer);c.hardPageShadow=d("<div class='wowbook-hard-page-shadow'></div>").css({display:"none"}).appendTo(e);!d.support.opacity&&d.wowBook.support.filters&&
d.wowBook.applyAlphaImageLoader(["wowbook-fold-gradient","wowbook-fold-gradient-flipped","wowbook-shadow-fold","wowbook-shadow-fold-flipped"]);c.shadowContainer.css("position","relative");this.leftHandle=d("<div class='wowbook-handle wowbook-left'></div>").data("corner","l").appendTo(e);this.rightHandle=d("<div class='wowbook-handle wowbook-right'></div>").data("corner","r").appendTo(e);Modernizr.csstransforms3d&&(f=d("<div>").css("transform","perspective(1px)"),this.perspectiveUnit="none"!=f.css("transform")?
"px":"",f=null);d.browser.msie&&d(".wowbook-handle",a).css({backgroundColor:"#fff",opacity:"0.01"});d(".wowbook-handle",e).bind("mousedown.wowbook",function(a){return c.pageEdgeDragStart(a)});b.curl&&d(".wowbook-handle",e).hover(function(a){if(!c.curlTimer){var b=this==c.leftHandle[0]?c.leftPage():c.rightPage();if(b){var f=b.offset(),e=a.pageY-f.top;c.curlTimer=setTimeout(function(){c.curl(b,e>c.pageHeight/2)},120)}}},function(){c.curlTimer=clearTimeout(c.curlTimer);c.uncurl()});var g;d(".wowbook-handle",
e).on("mousedown.wowbook",function(){g=d.now()}).on("mouseup.wowbook",function(){if(!((new Date).getTime()-g>c.opts.handleClickDuration)){c.stopAnimation();var a=d(this).data("corner");"r"===a&&c.advance();"l"===a&&c.back()}});var h=!1;a.hover(function(a){if(c.pauseOnHover){h=c.slideShowTimer;a=d(c.opts.controls.slideShow);var b=a.hasClass("wowbook-disabled");c.stopSlideShow();a.toggleClass("wowbook-disabled",b)}},function(){c.pauseOnHover&&h&&c.startSlideShow()});this.clipBoundaries&&(this.origin.wrap("<div class='wowbook-clipper'><div class='wowbook-inner-clipper'></div></div>"),
d(".wowbook-inner-clipper",a).css({position:"absolute",width:"100%",overflow:"hidden"}),this.clipper=d(".wowbook-clipper",a).css({position:"absolute",left:0,top:0,width:"100%",overflow:"hidden",zIndex:1}));this.detectBestZoomMethod();a.wrapInner("<div class='wowbook-zoomwindow'><div class='wowbook-zoomcontent'></div></div>");this.zoomWindow=d(".wowbook-zoomwindow",a);this.zoomContent=d(".wowbook-zoomcontent",a);d.browser.ie8mode&&this.zoomContent.wrapInner("<div class='IE8-zoom-helper'style='position:relative'></div>");
this.zoomWindow.css({position:"absolute",top:0});this.zoomContent.css({position:"absolute",left:0,top:0});this.setDimensions(this.opts.width,this.opts.height);b.scaleToFit&&(this.scaleToFit(),this.responsive());this.fillToc();e=b.useTranslate3d;Modernizr.csstransforms3d&&e&&(d.wowBook.useTranslate3d=!0==e||"mobile"==e&&d.wowBook.utils.isMobile());this.rtl&&(this.startPage=this.pages.length-1);if(b.deepLinking&&this.getLocationHash()){var k;try{k=c.selectorToPage("#"+this.getLocationHash())}catch(m){}void 0===
k&&(k=c.locationHashToPage());"number"===typeof k&&(c.startPage=k,r(c.elem)||c.elem[0].scrollIntoView())}this.flipSound&&(this.audio=this.createAudioPlayer());if(this.opts.keyboardNavigation)d(document).on("keydown.wowbook",function(a){d(a.target).filter("input, textarea, select").length||(a.which===c.opts.keyboardNavigation.back&&c.back(),a.which===c.opts.keyboardNavigation.advance&&c.advance())});d(window).on("hashchange.wowbook",function(){var a=window.location.hash;if(a===c.locationHashSetTo)c.locationHashSetTo=
void 0;else{var b=(a=""===a&&!c.locationEndsInHash())?c.startPage:c.locationHashToPage();"number"===typeof b&&(c.gotoPage(b,!a),a||r(c.elem)||c.elem[0].scrollIntoView())}});b.forceBasicPage&&(this.foldPage=this.holdHardpage=this.foldPageBasic);d.wowBook.support.transform||(this.foldPage=this.foldPageBasic,d.wowBook.support.filters||(this.holdHardpage=this.foldPageBasic));this.mouseWheel&&a.mousewheel(function(a,b){if(c.mouseWheel)return"zoom"===c.mouseWheel?(0<b&&c.zoomIn(),0>b&&c.zoomOut(),c.zoomedAt(a)):
(0<b&&c.advance(),0>b&&c.back()),!1});this.opts.touchEnabled&&this.touchSupport();this.controllify(this.opts.controls);this.opts.thumbnails&&this.createThumbnails();this.showPage(this.startPage,!1);this.zoom(this.opts.zoomLevel);this.callRAFCallback=function(){c.rafCallback()};window.raf(this.callRAFCallback);b.slideShow&&this.startSlideShow()}function u(a,b){var c=Math.cos(b),f=Math.sin(b);return{x:c*a.x-f*a.y,y:f*a.x+c*a.y}}function r(a){var b=d(window).height(),c=a.offset(),f=d(window).scrollTop();
return c.top>f&&c.top+a.height()<f+b}function t(a,b,c){var f,e,g,h;f=e=0;if(!d.wowBook.support.boxSizing){var k;f="none"==a.css("borderTopStyle")?0:q[k=a.css("borderTopWidth")]||parseFloat(k);e="none"==a.css("borderRightStyle")?0:q[k=a.css("borderRightWidth")]||parseFloat(k);g="none"==a.css("borderBottomStyle")?0:q[k=a.css("borderBottomWidth")]||parseFloat(k);h="none"==a.css("borderLeftStyle")?0:q[k=a.css("borderLeftWidth")]||parseFloat(k);e=parseFloat(a.css("paddingLeft"))+parseFloat(a.css("paddingRight"))+
h+e;f=parseFloat(a.css("paddingTop"))+parseFloat(a.css("paddingBottom"))+f+g}a.css("width",b-e);a.css("height",c-f)}d.wowBook=function(a){return d(a).data("wowBook")};d.wowBook.support={};d.fn.wowBook=function(a){if("string"===typeof a){var b=Array.prototype.slice.call(arguments,1);if("options"===a||"prop"===a){var c=d.wowBook(this[0]),f=b[0];return 1<b.length?c[f]=b[1]:c[f]}return this.each(function(){var c=d.wowBook(this);c[a].apply(c,b)})}var e=d.extend({},d.wowBook.defaults,a);return this.each(function(){var a=
new l(this,e);d(this).data("wowBook",a)})};l.prototype={destroy:function(){this.callRAFCallback=d.noop;this.curlTimer=clearTimeout(this.curlTimer);d("*").add(document).add(window).off(".wowbook");this.destroyThumbnails();this.stopSlideShow();this.stopAnimation(!1);this.elem.empty().removeData().off()},setDimensions:function(a,b){this.zoomed&&this.zoom(1);this.currentScale=1;var c=this.elem,f=this.pageWidth;c.css({height:b,width:a});var e=c.height();this.pageWidth=c.width()/2;this.pageHeight=e;this._originalHeight||
(this._originalHeight=this.pageHeight);this._originalWidth||(this._originalWidth=2*this.pageWidth);var g=this.origin.css({width:"100%",height:e});if(f&&this.opts.centeredWhenClosed){var h=parseFloat(g.css("left"),10);g.css("left",h/(f/this.pageWidth))}this.bookShadow.css({width:a,height:b});for(var h=!1,k=0,m=this.pages.length;k<m;k++)this.pages[k].css({width:this.pageWidth,height:this.pageHeight,left:h?0:this.pageWidth}),h=!h,f=d(".wowbook-page-content",this.pages[k]),t(f,this.pageWidth,this.pageHeight);
this.opts.gutterShadow&&d(".wowbook-gutter-shadow",c).css("height",this.pageHeight);this.positionBookShadow();this.shadowClipper.css({width:c.width(),height:e});this.hardPageShadow.css({width:this.pageWidth,height:this.pageHeight});this.opts.handleWidth&&d(".wowbook-handle",g).css("width",this.opts.handleWidth);this.rightHandle.css("left",a-this.rightHandle.width());this.clipBoundaries&&(g=Math.ceil(Math.sqrt(this.pageWidth*this.pageWidth+this.pageHeight*this.pageHeight)),g=[this.pageHeight-g,c.width(),
g,0],this.origin.css("top",-g[0]),d(".wowbook-inner-clipper",c).css({width:"100%",height:g[2]-g[0],top:g[0]}),this.clipper.css({width:"100%",height:e}));this.zoomWindow.css({width:2*this.pageWidth,height:e});this.zoomContent.css({width:2*this.pageWidth,height:e});this.corners={tl:[0,0],bl:[0,this.pageHeight],tr:[this.pageWidth,0],br:[this.pageWidth,this.pageHeight],l:[0,0],r:[this.pageWidth,0]};this.thumbnails&&this.updateThumbnails()},scale:function(a){if(d.wowBook.support.transform){this.zoomed&&
this.zoom(1);this.currentScale=a;var b=this.zoomContent;this.opts.zoomUsingTransform?b.css({transform:"scale("+a+")",transformOrigin:"0 0"}):b.css("zoom",a);this.elem.css({height:this._originalHeight*a,width:this._originalWidth*a});if(this.opts.onResize)this.opts.onResize(this)}},scaleToFit:function(a,b){var c=a;if(!d.isNumeric(a)){var f=d(a||this.opts.scaleToFit);if(!f.length)throw"jQuery selector passed to wowbook.resize did not matched in any DOM element.";c=f.width();b=f.height()}f=this._originalWidth/
this._originalHeight;b*f<=c||(b=c/f);this.scale(b/this._originalHeight)},resize:function(a,b){this.setDimensions(a,b);if(this.opts.onResize)this.opts.onResize(this)},responsive:function(){var a=this;d(window).on("resize.wowbook",function(){a.scaleToFit()})},insertPages:function(a,b){for(var c=0,f=a.length;c<f;c++)this.insertPage(a[c],!0);this.updateBook(b)},insertPage:function(a,b){a=d(a).addClass("wowbook-page-content");var c=d("<div class='wowbook-page'></div>").css({width:this.pageWidth,height:this.pageHeight,
display:"none",position:"absolute"}).appendTo(this.pagesContainer).append(a);d.wowBook.support.boxSizing&&a.css(d.wowBook.support.boxSizing,"border-box");t(a,this.pageWidth,this.pageHeight);c.hardPageSetByUser=a.hasClass("wowbook-hardpage");this.opts.gutterShadow&&d("<div class='wowbook-gutter-shadow'></div>").appendTo(a).css("height",this.pageHeight);this.pages.push(c);b||this.updateBook();return c},removePages:function(a,b){arguments.length||(a=0,b=-1);this.holdedPage&&this.releasePage(this.holdedPage);
var c=this.pages;b=(b||a)+1||c.length;var f=c.slice(a,b),e=c.slice(b);c.length=0>a?c.length+a:a;c.push.apply(c,e);for(var e=0,d=f.length;e<d;e++)f[e].remove();this.updateBook();return c.length},updateBook:function(a){this.doPageNumbering();this.findPagesType();this.positionBookShadow();for(var b=!1,c,f=0,e=this.pages.length;f<e;f++)c=this.pages[f].toggleClass("wowbook-left",b).toggleClass("wowbook-right",!b).data({pageIndex:f,holded:!1}),c.pageIndex=f,b=!b;this.findSections();a||this.showPage(this.currentPage)},
doPageNumbering:function(){var a=this.opts;if(a.pageNumbers){var b=a.numberedPages,a=this.pages.length-1,c=this.pageIsOnTheLeft(a);"all"==b&&(b=[0,-1]);b||(b=[2,c?-3:-2]);var f=b[0],b=b[1];0>f&&(f=a+f+1);0>f&&(f=0);f>this.pages.length-1&&(f=a);0>b&&(b=a+b+1);0>b&&(b=0);b>this.pages.length-1&&(b=a);for(var e=this.opts.firstPageNumber,c=0;c<f;c++)d(".wowbook-page-number",this.pages[c]).remove();for(c=b+1;c<a;c++)d(".wowbook-page-number",this.pages[c]).remove();for(c=f;c<=b;c++)a=d(".wowbook-page-number",
this.pages[c]),a.length||(a=d(".wowbook-page-content",this.pages[c]),a=d('<div class="wowbook-page-number"></div>').appendTo(a)),a.html(e++)}},findPagesType:function(){var a=this.opts,b={},c,f,e;e=a.hardPages||[];var d=!0===e;if(!d)for(a.hardcovers&&(e.push(0,1,-1),this.pageIsOnTheLeft(this.pages.length-1)&&e.push(-2)),a=0,f=e.length;a<f;a++)c=e[a],0>c&&(c=this.pages.length+c),0<=c&&c<this.pages.length&&(b[c]=!0);for(a=this.pages.length;a--;)e=d||b[a]||this.pages[a].hardPageSetByUser,this.pages[a].toggleClass("wowbook-hardpage",
e).isHardPage=e},showPage:function(a,b){0>a&&(a=0);a>this.pages.length-1&&(a=this.pages.length-1);for(var c=a-(1-a%2),f=c+1,e=this.pageWidth,g=!1,h,k,m=0,t=this.pages.length;m<t;m++)h=g?m:t-m,k=this.transparentPages?g?m<=c?"block":"none":m>=f?"block":"none":m===c-2||m===c||m===f||m===f+2?"block":"none",this.pages[m].data("zIndex",h).css({display:k,left:g?0:e,top:0,zIndex:h}),g=!g;c=0<a;f=this.rightPage(a);g=!c;h=!(f&&this.backPage(f.pageIndex));this.leftHandle.toggleClass("wowbook-disabled",g);this.rightHandle.toggleClass("wowbook-disabled",
h);this.toggleControl("back",g);this.toggleControl("next",h);this.toggleControl("first",g);this.toggleControl("last",h);(g=this.onShowPage)&&d.isFunction(g)&&!this.isOnPage(a)&&(g(this,this.pages[a],a),(h=this.otherPage(a))&&g(this,this.pages[h],h));this.currentPage=a;this.opts.centeredWhenClosed&&this.origin.css("left",c&&f?0:c?e/2:-e/2);this.positionBookShadow();!1!==b&&this.opts.updateBrowserURL&&this.locationHashToPage()!=a&&(this.locationHashSetTo=window.location.hash=this.pageToLocationHash(a));
this.showThumbnail()},holdPage:function(a,b,c,f,e){"number"===typeof a&&(a=this.pages[a]);if(a){var d=a.data("pageIndex"),h=this.pages.length-1,k=this.pageIsOnTheLeft(h);if(!f)f=this.pageIsOnTheLeft(d)?"l":"r";else if(!this.corners[f]||(this.pageIsOnTheLeft(d)?/r/:/l/).test(f))return;void 0===e&&(e=this.backPage(d));if(e){var m=e.data("pageIndex");a.data("holded_info",[b,c,f]);if(this.centeredWhenClosed&&(0===d||0===m||k&&(m===h||d===h))){var t=0,n,s=this.pageWidth,w,p,l,v,u,q,r,A;0===d&&(w=-s/2,
p=-s/4,l=0,v=-s/2,u=-s,q=p,r=u,A=b);d===h&&k&&(w=s,p=3*s/2,l=s/2,v=0,u=s,q=2*s,r=b,A=q);0===m&&(w=s/2,p=d===h?s:3*s/2,l=d===h?s/2:0,v=-s/2,u=w,q=2*s,r=b,A=q);m===h&&k&&(w=0===d?0:-s/2,p=s/2,l=s/2,v=0===d?-s/2:0,u=-s,q=p,r=u,A=b);b<w&&(t=l,n=r);b>p&&(t=v,n=A);b>=w&&b<=p&&(b=(b-w)/(p-w),t=l+b*(v-l),n=u+b*(q-u));b=n;this.origin.css("left",t);this.positionBookShadow()}this.zoomed||"basic"==this.pageType(a)||"basic"==this.pageType(e)?this.foldPageBasic(a,b,c,f,e):a.isHardPage||e.isHardPage?this.holdHardpage(a,
b,c,f,e):this.foldPage(a,b,c,f,e);if(!a.data("holded")&&(a.addClass("wowbook-page-holded"),e.addClass("wowbook-page-holded"),a.data("holded",!0),this.holdedPage=a,this.holdedPageBack=e,this.shadows&&this.shadowClipper.css("display","block"),this.clipBoundaries&&this.clipper.css("overflow","visible"),this.positionBookShadow(),this.opts.onHoldPage))this.opts.onHoldPage(this,d,a,e)}}},foldPage:function(a,b,c,f,e){this._currentFlip||(this._currentFlip=this.foldPageStart(a,b,c,f,e));this._currentFlip.page==
a&&(this._currentFlip.x=b,this._currentFlip.y=c,this._currentFlip.page.data("holdedAt",{x:b,y:c}),this._currentFlip.corner=f,this.foldPageStyles(this._currentFlip))},foldPageStart:function(a,b,c,f,e){var d={};"number"===typeof a&&(a=this.pages[a]);d.book=this;d.page=a;d.pageIndex=a.data("pageIndex");void 0===e&&(e=this.backPage(d.pageIndex));if(e&&e.length){d.back=e;d.pageContent=a.children().first();d.backContent=e.children().first();var h=this.pageWidth,k=this.pageHeight;f||(f="tl");if("l"==f||
"r"==f){var m={x:"l"==f?0:h,y:c};a.data("grabPoint",m);d.grabPoint=m;f=(c>=m.y?"t":"b")+f}d.page.data("holdedAt",{x:b,y:c});d.x=b;d.y=c;d.page.data("holdedCorner",f);d.corner=f;d.pageDiagonal=Math.sqrt(h*h+k*k);d.page.css("clip","rect(-1000px 2000px 2000px 0px)");d.pageLeft=parseFloat(a.css("left"));e.css({left:d.pageLeft+"px",zIndex:1E3,clip:"rect(-1000px 2000px 2000px 0px)"});d.shadowHeight=2*Math.ceil(d.pageDiagonal);d.shadowTop=-(d.shadowHeight-k)/2;this.internalShadow.css({display:"block",height:d.shadowHeight});
d.foldShadowWidth=this.foldShadow.width();this.foldShadow.css({display:"block",height:d.shadowHeight});this.foldGradientContainer.appendTo(d.backContent);d.foldGradientWidth=this.foldGradientElem.width();d.foldGradientHeight=2*Math.ceil(d.pageDiagonal);this.foldGradientElem.css("height",d.foldGradientHeight);this.foldGradientContainer.css({position:"absolute",width:d.foldGradientWidth,height:d.foldGradientHeight,top:0,left:0,display:"none"});d.foldGradientVisible=!1;return d}},foldPageStyles:function(a){var b=
this.pageWidth,c=this.pageHeight,f=b/2,e=c/2,g=d.wowBook.utils.translate,h=a.pageLeft,k=a.x,m=a.y,t=a.back,n=a.corner||"tl";if("l"==n||"r"==n){var s=a.page.data("grabPoint");s||(s={x:"l"==n?0:b,y:m},page.data("grabPoint",s));n=(m>=s.y?"t":"b")+(this.pageIsOnTheLeft(a.pageIndex)?"l":"r");a.corner=n;a.page.data("holdedCorner",n);var l=k-s.x,p=m-s.y,l=Math.atan2(p,l),s={x:0,y:(m>=s.y?0:c)-s.y},s=u(s,2*l),k=s.x+k,m=s.y+m}a.page.data("holdedAt",{x:k,y:m});a.page.data("holdedCorner",n);var s=this.corners[n],
n=b-s[0],q=s[1],l=k-n,p=m-q,v=Math.sqrt(l*l+p*p);v>b&&(k=n+b*l/v,m=q+b*p/v);var q=c-q,l=k-n,p=m-q,v=Math.sqrt(l*l+p*p),r=a.pageDiagonal;v>r&&(k=n+r*l/v,m=q+r*p/v);n=s[0];s=s[1];s==m&&(m=s+0.001);l=k-n;p=m-s;v=Math.sqrt(l*l+p*p);k=v/2;l=Math.atan2(p,l);p=Math.tan(l);m=l;l=180*l/Math.PI;q={x:n-f,y:e-s};r=u(q,m);v=r.x+k+f+0.5;a.pageContent.css("transform",g(-v,0)+" rotate("+(-l).toFixed(7)+"deg)");a.page.css("transform",g((Math.cos(m)*v).toFixed(5),(Math.sin(m)*v).toFixed(5))+" rotate("+l.toFixed(7)+
"deg)");r=this.calculateOpacity(k,b,this.shadowThreshold,50);if(this.shadows&&0<r){var C=a.shadowTop;this.internalShadow.css({transform:g(v+h,C)+" rotate("+l+"deg)",transformOrigin:f-v+"px "+(e+(a.shadowHeight-c)/2)+"px"});v-=a.foldShadowWidth;this.foldShadow.css({transform:g(v+h,C)+" rotate("+l+"deg)",transformOrigin:f-v+"px "+(e+(a.shadowHeight-c)/2)+"px"});this.shadowContainer.css({opacity:r,display:"block"})}else this.shadowContainer.css("display","none");t.show();q.x=-q.x;r=u(q,-m);v=r.x-k+f-
1;c={x:r.x-k,y:r.y+k*p};h={x:r.x-k,y:r.y-k/(0==p?1E-4:p)};c=u(c,-m);h=u(h,-m);h=-(h.x+f);c=-(c.y-e);a.backContent.css("transform",g(-v,0)+" rotate("+l+"deg)");a.back.css("transform",g((n+h+Math.cos(m)*v).toFixed(5),(s-c+Math.sin(m)*v).toFixed(5))+" rotate("+l+"deg)");r=this.calculateOpacity(2*k,2*b,this.foldGradientThreshold,50);this.foldGradient&&0<r?(this.foldGradientContainer.css({opacity:r,display:"block",transform:g(b-n-a.foldGradientWidth/2,s-a.foldGradientHeight/2)+" rotate("+-l+"deg)"}),this.foldGradientElem.css("transform",
g(-k+a.foldGradientWidth/2,0)),a.foldGradientVisible||(this.foldGradientContainer.css("display","block"),a.foldGradientVisible=!0)):a.foldGradientVisible&&(this.foldGradientContainer.css("display","none"),a.foldGradientVisible=!1)},holdHardpage:function(a,b,c,f,d){this._currentFlip||(this._currentFlip=this.flipHardPageStart(a,b,c,f,d));this._currentFlip.page==a&&(this._currentFlip.x=b,this._currentFlip.y=c,this._currentFlip.page.data("holdedAt",{x:b,y:c}),this._currentFlip.corner=f,this.flipHardPageStyles(this._currentFlip))},
flipHardPageStart:function(a,b,c,f,d){this.clipBoundaries&&this.clipper.children(".wowbook-inner-clipper").css("overflow","visible");var g={};"number"===typeof a&&(a=this.pages[a]);g.book=this;g.page=a;g.pageIndex=a.data("pageIndex");void 0===d&&(d=this.backPage(g.pageIndex));if(d&&d.length){g.back=d;var h=this.pageWidth;f||(f="tl");a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",f);a.css("zIndex",1E3);d.css("zIndex",1E3);this.opts.use3d&&Modernizr.csstransforms3d&&(a.css(Modernizr.prefixed("perspectiveOrigin"),
"0 50%"),d.css(Modernizr.prefixed("perspectiveOrigin"),"0 50%"));b=this.pageIsOnTheLeft(g.pageIndex)?h:0;a.css("transformOrigin",b+"px 50%");d.css("transformOrigin",h-b+"px 50%");this.shadows&&this.hardPageShadow.css("display","block");return g}},flipHardPageStyles:function(a){var b=a.page,c=a.back;x=a.x;y=a.y;var f=this.pageIsOnTheRight(a.pageIndex),e=this.pageWidth,g=this.pageHeight;(a=a.corner)||(a="tl");b.data("holdedAt",{x:x,y:y});b.data("holdedCorner",a);a=f?e-x:x;var h=f?0:e,k;0>a&&(a=0);a=
(k=a<e)?b:c;(k?c:b).css("display","none");b=f!=k;c=x-h;c>e&&(c=e);c<-e&&(c=-e);h=-Math.sqrt(1600*(1-c*c/((e+15)*(e+15))));f=Math.abs(c/e);h=1==f?0:Math.atan2(h,c);if(this.opts.use3d&&Modernizr.csstransforms3d){var m;m=b?-this._calculateAngleFromX(-c,e):this._calculateAngleFromX(c,e);this.animating&&(k=this._animationData,this.curledPage||k.curled?(k.curled=!0,k.angle||(h={from:m,to:0},k.angle=h,m=c+k.dx,h.to=b?-this._calculateAngleFromX(-m,e):this._calculateAngleFromX(m,e),Math.abs(c)==e&&(h.from=
0),Math.abs(m)==e&&(h.to=0),h.delta=h.to-h.from),m=k.angle.from-k.angle.delta*(k.from.x-x)/k.dx):(Math.abs(x-k.from.x),Math.abs(k.dx/2)));a.css({transform:"perspective("+this.opts.perspective+this.perspectiveUnit+") rotate3d(0, 1, 0, "+m+"deg)",display:"block"})}else a.css({transform:"skewY("+h+"rad) scaleX("+f+")",display:"block"});!d.wowBook.support.transform&&d.wowBook.support.filters&&(f="M11="+f+", M12=0, M21="+Math.tan(h)*f+", M22=1",a.css("filter","progid:DXImageTransform.Microsoft.Matrix("+
f+", sizingMethod='auto expand')"),a.css({marginTop:g-a.height(),marginLeft:b?e-a.width():0}));this.shadows&&this.hardPageShadow.css({left:b?0:e,opacity:0.5*Math.abs(c/e)})},_calculateAngleFromX:function(a,b,c){var f=2*b/3;if(a>f){var d=this._calculateAngleFromX(f,b,c);return d+(a-f)/(b-f)*(0-d)}c=c||this.opts.perspective;f=180/Math.PI;d=b*b;c*=c;var g=a*a;a=Math.acos((b*c*a-Math.sqrt(d*d*c*g+d*d*g*g-d*c*g*g))/(d*c+d*g));return a=-a*f},foldPageBasic:function(a,b,c,d,e){this._currentFlip||(this._currentFlip=
this.foldPageBasicStart(a,b,c,d,e));this._currentFlip&&this._currentFlip.page==a&&(this._currentFlip.x=b,this._currentFlip.y=c,this._currentFlip.page.data("holdedAt",{x:b,y:c}),this._currentFlip.corner=d,this.foldPageBasicStyles(this._currentFlip))},foldPageBasicStart:function(a,b,c,d,e){var g={};"number"===typeof a&&(a=this.pages[a]);g.book=this;g.page=a;g.pageIndex=a.data("pageIndex");void 0===e&&(e=this.backPage(g.pageIndex));if(e&&e.length){g.back=e;var h=this.pageHeight,k=this.pageIsOnTheRight(g.pageIndex);
d||(d="tl");a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",d);e.css("zIndex",1E3);a.data("foldPageBasic",!0);g.foldGradientWidth=this.foldGradientElem.width();g.foldShadowWidth=this.foldShadow.width();this.internalShadow.css("display","none");this.foldShadow.css({display:"none",height:h,transform:"",top:0}).toggleClass("wowbook-shadow-fold-flipped",k);this.shadowContainer.css("display","block");a=e.children().first();this.foldGradientContainer.appendTo(a).css({width:g.foldGradientWidth,height:h,
top:0,transform:"",zIndex:1E9});this.foldGradientElem.css({left:0,height:h}).toggleClass("wowbook-fold-gradient-flipped",k);return g}},foldPageBasicStyles:function(a){var b=a.page,c=a.back;x=a.x;y=a.y;var d=this.pageWidth,e=a.corner;e||(e="tl");b.data("holdedAt",{x:x,y:y});b.data("holdedCorner",e);var g=(e=this.pageIsOnTheLeft(a.pageIndex))?x:d-x;0>g&&(g=0);g>2*d&&(g=2*d);var h=g/2,k,m;e?(k="rect(-1000px 1000px 1000px "+h+"px)",m="rect(-1000px 1000px 1000px "+(d-h)+"px)",g-=d):(k="rect(-1000px "+
(d-h)+"px 1000px -1000px)",m="rect(-1000px "+h+"px 1000px -1000px)",g=d-g+d);b.css("clip",k);c.css({clip:m,left:g,display:"block"});b=this.calculateOpacity(2*h,2*d,this.shadowThreshold,50);this.shadows&&0<b?(c=e?h-a.foldShadowWidth:d-h+d,this.shadowContainer.css("opacity",b),this.foldShadow.css({left:c,display:"block"})):this.foldShadow.css("display","none");b=this.calculateOpacity(2*h,2*d,this.foldGradientThreshold,50);this.foldGradient&&0<b?(c=e?d-h:h-a.foldGradientWidth,this.foldGradientContainer.css({opacity:b,
left:c,display:"block"})):this.foldGradientContainer.css("display","none")},stopAnimation:function(a){arguments.length||(a=!0);d(this).stop(!0,a);this.animating=!1},flip:function(a,b,c,f){f||(f=d.isPlainObject(a)?a:{});f.from||(f.from=[]);f.to||(f.to=[]);var e=this;if(!e.animating){e.animating=!0;c||(c=f.page||e.holdedPage);var g=c.data("holded_info");c.data("holdedAt");var h=f.corner||c.data("holdedCorner"),k=d.easing[f.easing]||f.easing||function(a){return 1==a?1:-Math.pow(2,-10*a)+1};a={page:c,
back:f.back||e.holdedPageBack||e.backPage(c.pageIndex),initialX:void 0!=f.from[0]?f.from[0]:g[0],initialY:void 0!=f.from[1]?f.from[1]:g[1],finalX:void 0!=f.to[0]?f.to[0]:a,finalY:void 0!=f.to[1]?f.to[1]:b,corner:h||g[2],duration:f.duration,complete:function(){e.animating=!1;d.isFunction(f.complete)&&f.complete()},easing:k,arc:f.arc,dragging:f.dragging,start:d.now(),finished:!1};a.deltaX=a.finalX-a.initialX;a.deltaY=a.finalY-a.initialY;this._animationData={from:{x:a.initialX,y:a.initialY},to:{x:a.finalX,
y:a.finalY},dx:a.deltaX};void 0==a.duration&&(a.duration=this.turnPageDuration*Math.abs(a.deltaX)/(2*this.pageWidth));a.duration<this.opts.turnPageDurationMin&&(a.duration=this.opts.turnPageDurationMin);!c.isHardPage&&0.4<a.duration/this.turnPageDuration&&this.playFlipSound();this.currentFlip=a}},rafCallback:function(){window.raf(this.callRAFCallback);if(this.currentFlip&&!this.currentFlip.finished){var a=this.currentFlip,b=(d.now()-a.start)/a.duration;1<=b&&(b=1);a.x=a.initialX+a.deltaX*a.easing(b,
a.duration*b,0,1,a.duration);a.y=a.initialY+a.deltaY*a.easing(b,a.duration*b,0,1,a.duration);a.arc&&(a.y-=(0.5-Math.abs(0.5-a.easing(b,a.duration*b,0,1)))*this.pageHeight/10);a.dragging&&(a.x=a.initialX+0.2*a.deltaX,a.y=a.initialY+0.2*a.deltaY,a.initialX=a.x,a.initialY=a.y,a.deltaX=a.finalX-a.initialX,a.deltaY=a.finalY-a.initialY,1>a.deltaX&&1>a.deltaY&&1==b);this.holdPage(a.page,a.x,a.y,a.corner,a.back);1==b&&(a.finished=!0,a.complete&&a.complete())}},releasePages:function(){for(var a=0,b=this.pages.length;a<
b;a++)this.pages[a].data("holded")&&this.releasePage(a)},releasePage:function(a,b,c,d){"number"===typeof a&&(a=this.pages[a]);var e=this,g=a.data("holdedAt"),h=a.data("holdedCorner");if(b&&g)this.flip({from:[g.x,g.y],to:this.corners[h],page:a,easing:"linear",duration:1E4,duration:d,complete:function(){e.releasePage(a)}});else if(b=a.data("pageIndex"),void 0===c&&(c=this.holdedPageBack||this.backPage(b)),this.holdedPageBack=this.holdedPage=null,a.data({holded_info:null,holdedAt:null,holdedCorner:null,
grabPoint:!1,foldPageBasic:null,holded:!1}),this.clipBoundaries&&!this.zoomed&&(this.clipper.css("overflow","hidden"),this.clipper.children(".wowbook-inner-clipper").css("overflow","hidden")),this.shadowClipper.css("display","none"),this.internalShadow.parent().hide(),this.foldGradientContainer.hide(),this.hardPageShadow.hide(),this.resetPage(a),c&&c.length&&(this.resetPage(c),c.hide()),this.foldShadow.removeClass("wowbook-shadow-fold-flipped").css({transform:"",left:""}),this.foldGradientElem.removeClass("wowbook-fold-gradient-flipped").css("transform",
""),this.foldGradientContainer.css("transform","").appendTo(this.pagesContainer),this.positionBookShadow(),this.opts.onReleasePage)this.opts.onReleasePage(this,b,a,c)},resetPage:function(a){this._currentFlip=void 0;a.removeClass("wowbook-page-holded");this.resetCSS||(this.resetCSS={transform:"",transformOrigin:"",clip:"auto",marginLeft:0,marginTop:0,filter:""});var b=this.pageWidth,c=this.pageHeight;a.css(this.resetCSS).css({zIndex:a.data("zIndex"),width:b,height:c,left:this.pageIsOnTheLeft(a.data("pageIndex"))?
0:b});d.browser.msie&&9>d.browser.version&&a.attr("style",a.attr("style").replace(/clip\: [^;]+;/i,""));a=d(".wowbook-page-content",a);a.css(this.resetCSS);t(a,b,c)},gotoPage:function(a,b){var c,d;if(!this.animating&&(this._cantStopAnimation=!0,"string"===typeof a&&"#"==a.charAt(0)&&(a=this.selectorToPage(a)),0>a&&(a=0),a>this.pages.length-1&&(a=this.pages.length-1),!this.isOnPage(a))){c=a<this.currentPage;var e=this,g=c?e.leftPage():e.rightPage();if(g){this.uncurl(!0);var h,k;c?(h=this.leftPage(a),
k=this.rightPage(a)):(h=this.rightPage(a),k=this.leftPage(a));var m=k&&k.is(":visible");if(c)for(var l=g.pageIndex-1;0<=l;l--)this.pages[l].css("display","none");else for(l=g.pageIndex+1,d=this.pages.length;l<d;l++)this.pages[l].css("display","none");h&&h.css("display","block");m&&k.css("display","block");var n=a;h=g.data("holdedAt");m=g.data("holdedAt");l=g.data("holdedCorner")||(c?"tl":"tr");c?(m=m||{x:0,y:0},c=2*e.pageWidth,d="bl"!=l?0:this.pageHeight):(m=m||{x:this.pageWidth,y:0},c=-e.pageWidth,
d="br"!=l?0:this.pageHeight);var t="linear";if(this.centeredWhenClosed&&(g.isHardPage||k.isHardPage)){var q=this.pages.length-1,t="easeOutCubic";0==this.currentPage&&(c+=this.pageWidth/2,a==q&&this.pageIsOnTheLeft(a)&&(c+=this.pageWidth/2));this.currentPage==q&&(c-=this.pageWidth/2,0==a&&(c-=this.pageWidth/2))}e.flip({from:[m.x,m.y],to:[c,d],easing:t,arc:!h,page:g,back:k,corner:l,complete:function(){e._cantStopAnimation=!1;e.releasePage(g,!1);e.showPage(n,b)}});return a}}},back:function(){return this.gotoPage(this.currentPage-
2)},advance:function(){return this.gotoPage(this.currentPage+2)},leftPage:function(a){a=void 0!==a?a:this.currentPage;this.pageIsOnTheRight(a)&&a--;return this.pages[a]||null},rightPage:function(a){a=void 0!==a?a:this.currentPage;this.pageIsOnTheLeft(a)&&a++;return this.pages[a]||null},pageIsOnTheRight:function(a){return!(a%2)},pageIsOnTheLeft:function(a){return!!(a%2)},otherPage:function(a){a+=this.pageIsOnTheRight(a)?-1:1;if(0>a||a>this.pages.length-1)a=null;return a},isOnPage:function(a){return"number"===
typeof a&&(a===this.currentPage||a===this.otherPage(this.currentPage))},backPage:function(a){a+=this.pageIsOnTheRight(a)?1:-1;return this.pages[a]},pageType:function(a){a="number"===typeof a?this.pages[a]:a;return a.isHardPage?"hard":a.find(".wowbook-page-content.wowbook-basic-page").length?"basic":"soft"},calculateOpacity:function(a,b,c,d){if(a<=c||a>=b-c)return 0;if(a>=d&&a<=b-d)return 1;a>d&&(a=b-a);return(a-c)/(d-c)},startSlideShow:function(){this.slideShowRunning=!0;this.advanceAfterTimeout(this.slideShowDelay);
d(this.opts.controls.slideShow).addClass("wowbook-disabled")},advanceAfterTimeout:function(a){var b=this;this.slideShowTimer=setTimeout(function(){if(b.animating||b.holdedPage)b.advanceAfterTimeout(100);else{var a=b.rtl?0:b.pages.length-1;b.rtl?b.back():b.advance();b.isOnPage(a)?b.stopSlideShow():b.advanceAfterTimeout(b.slideShowDelay+b.turnPageDuration)}},a)},stopSlideShow:function(){clearTimeout(this.slideShowTimer);this.slideShowTimer=void 0;this.slideShowRunning=!1;d(this.opts.controls.slideShow).removeClass("wowbook-disabled")},
toggleSlideShow:function(){this.slideShowRunning?this.stopSlideShow():this.startSlideShow()},findSections:function(a){a&&(this.sectionDefinition=a);var b=this.sectionDefinition;a=[];var c;"string"===typeof b&&(c=b,b=[],d(c,this.elem).each(function(a,c){b.push(["#"+c.id,d(c).html()])}));if(d.isArray(b)){for(var f=0,e=b.length;f<e;f++){c=b[f];if("string"===typeof c)try{c=[c,d(c,this.elem).html()]}catch(g){continue}try{c[2]=this.selectorToPage(c[0])}catch(h){continue}void 0!==c[2]&&a.push({id:c[0],title:c[1],
page:c[2]})}a=a.sort(function(a,b){return a.page-b.page})}return this.sections=a},pageToSection:function(a){for(var b=this.sections,c,d=0,e=b.length;d<e&&!(b[d].page>a);d++)c=b[d];return c},currentSection:function(){return this.pageToSection(this.currentPage)},fillToc:function(a,b){var c=d(a||this.opts.toc),f,e,g="";if(0!==c.length){f=this.sections;"undefined"===typeof b&&(b=this.opts.tocTemplate);b||(g=c.is("UL, OL")?"<li>":"<div>",b='<a href="${link}">${section}</a>');for(var h=0,k=f.length;h<k;h++)e=
f[h],e=b.replace(/\$\{link\}/g,"#"+this.id+"/"+e.id.substr(1)).replace(/\$\{section\}/g,e.title).replace(/\$\{page\}/g,e.page),d(e).appendTo(c).wrap(g)}},locationHashToPage:function(a,b){void 0===a&&(a=window.location.hash);if(a=="#"+this.id+"/")return 0;a=a.slice(1).split("/");if(a[0]===this.id){if(1===a.length)return 0;var c=parseInt(a[1]);if(!isNaN(c))return Math.max(c-1,0);c=this.selectorToPage("#"+a[1]);if(void 0===c)return 0;isNaN(a[2])||(c+=Math.max(parseInt(a[2])-1,0));return+c}},pageToLocationHash:function(a){var b=
"",c=a+1;if(a=this.pageToSection(a))b+="/"+a.id.replace("#",""),c-=a.page;1<c&&(b+="/"+c);return"#"+this.id+(b||"/")},selectorToPage:function(a){a=d(a,this.elem).closest(".wowbook-page");if(a.length)return+a.data("pageIndex")},getLocationHash:function(){return window.location.hash.slice(1)},locationEndsInHash:function(a){void 0===a&&(a=window.location.href);return a.lastIndexOf("#")==a.length-1},zoom:function(a){for(var b=0,c=this.pages.length;b<c;b++)if(this.pages[b].data("holdedAt"))return;a<this.zoomMin&&
(a=this.zoomMin);a>this.zoomMax&&(a=this.zoomMax);if(a!==this.zoomLevel){this.zoomLevel=a;var f=this,b=this.zoomWindow,c=this.zoomContent,e=d(this.zoomBoundingBox),g=2*f.pageWidth*a*this.currentScale,h=f.pageHeight*a*this.currentScale,k=e.width(),m=e.height(),l=Math.min(g,k),n=Math.min(h,m),t=(2*this.pageWidth*this.currentScale-l)/2,q=(this.pageHeight*this.currentScale-n)/2;b.css({width:l,height:n,left:t,top:q});this.zoomContentOverflowed=g>k||h>m;var p=b.offset(),e=e[0]!==window?e.offset():{left:e.scrollLeft(),
top:e.scrollTop()};p.right=p.left+l;p.bottom=p.top+n;e.right=e.left+k;e.bottom=e.top+m;p.left<e.left&&b.css("left",t+(e.left-p.left));p.right>e.right&&b.css("left",t+(e.right-p.right));p.top<e.top&&b.css("top",q+(e.top-p.top));p.bottom>e.bottom&&b.css("top",q+(e.bottom-p.bottom));p=b.offset();k=c.offset();p.right=p.left+l;p.bottom=p.top+n;k.right=k.left+g;k.bottom=k.top+h;k.left>p.left&&c.css("marginLeft",0);k.right<p.right&&c.css("marginLeft",(parseFloat(c.css("marginLeft"))||0)+(p.right-k.right));
k.top>p.top&&c.css("marginTop",0);k.bottom<p.bottom&&c.css("marginTop",(parseFloat(c.css("marginTop"))||0)+(p.bottom-k.bottom));l===g&&c.css("marginLeft",0);n===h&&c.css("marginTop",0);this.opts.zoomUsingTransform?c.css({transform:"scale("+a*this.currentScale+")",transformOrigin:"0 0"}):c.css("zoom",a*this.currentScale);1===this.zoomLevel?(b.unbind("mousemove.wowbook").css({overflow:"visible",left:0,top:0}),this.clipBoundaries&&this.clipper.css("overflow","hidden"),c.css({marginLeft:0,marginTop:0})):
(this.clipBoundaries&&this.clipper.css("overflow","visible"),b.css("overflow","hidden"),this.zoomed||b.bind("mousemove.wowbook",function(a){f.zoomedAt(a)}));this.zoomed=1!==a;this.positionBookShadow();if(this.onZoom)this.onZoom(this);this.toggleControl("zoomIn",this.zoomLevel==this.zoomMax);this.toggleControl("zoomOut",this.zoomLevel==this.zoomMin)}},zoomIn:function(a){this.zoom(this.zoomLevel+(a||this.zoomStep))},zoomOut:function(a){this.zoom(this.zoomLevel-(a||this.zoomStep))},zoomedAt:function(a){if(this.zoomContentOverflowed){var b=
this.zoomLevel,c=this.zoomWindow.offset(),d=a.pageX-c.left;a=a.pageY-c.top;var e=this.zoomWindow.width(),c=2*this.pageWidth*b*this.currentScale-e,d=d/e,e=this.zoomWindow.height(),g=this.pageHeight*b*this.currentScale-e;adjust=this.opts.zoomUsingTransform?1:b;this.zoomContent.css({marginLeft:-c*d/adjust,marginTop:a/e*-g/adjust})}},detectBestZoomMethod:function(a,b,c){void 0===a&&(a=d.wowBook.support.transform);void 0===c&&(c=d.browser.ie8mode);a=d.browser.chrome||d.browser.webkit||d.browser.safari||
d.browser.opera||c||!a;this.opts.zoomUsingTransform=!a;return a?"zoom":"transform"},positionBookShadow:function(){var a=this.pages.length,b=!(!this.opts.bookShadow||this.zoomed||!a||3>a&&this.holdedPage);this.bookShadow.toggle(b);if(b){var b=this.pageWidth,c=this.currentPage,d=this.holdedPageBack&&this.holdedPageBack.pageIndex,e=d&&this.pageIsOnTheLeft(d),c=0<c,g=this.rightPage(),c=!c||0===d,d=!g||d===a-1&&e,a=c!=d;c&&d?this.bookShadow.hide():(d=this.opts.zoomUsingTransform?this.currentScale:1,this.bookShadow.css({left:(c?
b:0)+this.pagesContainer.position().left/d,width:a?b:2*b}))}},playFlipSound:function(){if(this.flipSound){var a=this.opts.onPlayFlipSound;d.isFunction(a)&&!1===a(this)||(this.audio||(this.audio=this.createAudioPlayer()),this.audio&&this.audio.play&&this.audio.play())}},toggleFlipSound:function(a){arguments.length||(a=!this.flipSound);this.flipSound=a;this.toggleControl("flipSound",!a)},createAudioPlayer:function(a,b){a||(a=this.opts.flipSoundPath);b||(b=this.opts.flipSoundFile);for(var c=[],f=0,e=
b.length;f<e;f++)c.push('<source src="'+a+b[f]+'">');return d("<audio preload>"+c.join("")+"</audio>")[0]},_untouch:function(a){return a.originalEvent.touches&&a.originalEvent.touches[0]||a},touchSupport:function(){var a=this;a.elem.bind("touchstart.wowbook",function(b){var c=b.originalEvent.touches;1<c.length||(a._touchStarted={x:c[0].pageX,y:c[0].pageY,timestamp:b.originalEvent.timeStamp,inHandle:d(b.target).hasClass("wowbook-handle")},a._touchStarted.inHandle&&a.pageEdgeDragStart(a._untouch(b)))});
d(document).on("touchmove.wowbook",function(b){if(a._touchStarted){var c=b.originalEvent.touches;a._touchEnded={x:c[0].pageX,y:c[0].pageY,timestamp:b.originalEvent.timeStamp};if(a._touchStarted.inHandle)return a.pageEdgeDrag(a._untouch(b));20<Math.abs(a._touchEnded.x-a._touchStarted.x)&&b.preventDefault();b.preventDefault()}});d(document).on("touchend.wowbook touchcancel.wowbook",function(b){if(a._touchStarted){!a._touchEnded&&d(b.target).hasClass("wowbook-handle")&&(b=d(b.target).data("corner"),
"r"===b&&a.advance(),"l"===b&&a.back());var c=a._touchStarted,f=a._touchEnded||a._touchStarted;a._touchStarted=null;a._touchEnded=null;if(c.inHandle)return a.pageEdgeDragStop({pageX:f.x}),!1;b=f.x-c.x;var e=f.y-c.y,c=f.timestamp-c.timestamp;if(!(20>Math.abs(b)||200<c)&&Math.abs(b)>Math.abs(e))return 0>b?a.advance():a.back(),!1}})},pageEdgeDragStart:function(a){if(this.animating&&!this.curledPage||this.zoomed||!d(a.target).hasClass("wowbook-handle"))return!1;var b=this,c=b.elem.offset();b.mouseDownAtLeft=
(a.pageX-c.left)/this.currentScale<b.pageWidth;b.pageGrabbed=b.mouseDownAtLeft?b.leftPage():b.rightPage();if(!b.pageGrabbed)return!1;this.uncurl(!0);b.pageGrabbedOffset=b.pageGrabbed.offset();this.opts.zoomUsingTransform&&(b.pageGrabbedOffset.left/=this.currentScale,b.pageGrabbedOffset.top/=this.currentScale);c=a.pageX/this.currentScale-this.pageGrabbedOffset.left;a=a.pageY/this.currentScale-this.pageGrabbedOffset.top;this.stopAnimation(!1);var f=b.mouseDownAtLeft?"l":"r";this.holdPage(this.pageGrabbed,
c,a);this.flip(c,a,this.pageGrabbed,{corner:f});d(document).bind("mousemove.wowbook",function(a){return b.pageEdgeDrag(a)}).bind("mouseup.wowbook",function(a){return b.pageEdgeDragStop(a)});return!1},pageEdgeDrag:function(a){var b=a.pageX/this.currentScale-this.pageGrabbedOffset.left;a=a.pageY/this.currentScale-this.pageGrabbedOffset.top;var c=this.mouseDownAtLeft?"l":"r";this.stopAnimation(!1);this.flip(b,a,this.pageGrabbed,{corner:c,dragging:!0});return!1},pageEdgeDragStop:function(a){var b=this.elem.offset();
a=(a.pageX-b.left)/this.currentScale<this.pageWidth;this._cantStopAnimation||this.stopAnimation(!1);this.mouseDownAtLeft&&!a?this.back():!this.mouseDownAtLeft&&a?this.advance():this.releasePage(this.pageGrabbed,!0);d(document).unbind("mousemove.wowbook mouseup.wowbook")},curl:function(a,b){if(!this.curledPage&&!this.holdedPage){void 0==a&&(a=this.currentPage);if("number"==typeof a||"string"==typeof a)a=this.pages[+a];if(a&&!a.isCurled){a.isCurled=!0;this.curledPage=a;var c=this.pageIsOnTheLeft(a.pageIndex),
d=c?0:this.pageWidth,e=b?this.pageHeight-1:2;this.flip({from:[d,e],to:[d+this.opts.curlSize*(c?1:-1),e+this.opts.curlSize*(b?-1:1)],corner:(b?"b":"t")+(c?"l":"r"),page:a,duration:400})}}},uncurl:function(a,b){if(this.curledPage){!0==a&&(b=!0,a=void 0);void 0==a&&(a=this.curledPage||this.currentPage);if("number"==typeof a||"string"==typeof a)a=this.pages[+a];a.isCurled&&(this.stopAnimation(!1),this.releasePage(a,!b,void 0,400),a.isCurled=!1,this.curledPage=null)}},initThumbnails:function(){var a=this.opts;
this.thumbnails=[];var b=this.thumbnailsContainer=d("<div class='wowbook-thumbnails'>").append("<div class='wowbook-wrapper'><div class='wowbook-back wowbook-button' /><div class='wowbook-clipper'><ul></ul></div><div class='wowbook-next wowbook-button' /></div>").css("display","none").css("transform","translateZ(0)").appendTo(d(a.thumbnailsParent));this.thumbnailsList=b.find("ul");this.thumbnailsClipper=b.find(".wowbook-clipper");a.thumbnailsContainerWidth&&b.width(a.thumbnailsContainerWidth);a.thumbnailsContainerHeight&&
b.height(a.thumbnailsContainerHeight);var c=a.thumbnailsPosition;if("left"==c||"right"==c)a.thumbnailsVertical=!0,"right"==c&&b.css({position:"absolute",left:"auto",right:"0px"});if("top"==c||"bottom"==c)a.thumbnailsVertical=!1,"bottom"==c&&b.css({position:"absolute",top:"auto",bottom:"0px"});b.addClass(a.thumbnailsVertical?"wowbook-vertical":"wowbook-horizontal");var f=this,e=a.thumbnailsVertical?"height":"width";this.thumbnailsBackButton=b.find(".wowbook-back.wowbook-button").click(function(){f._moveThumbnailsList(f.thumbnailsClipper[e]())});
this.thumbnailsNextButton=b.find(".wowbook-next.wowbook-button").click(function(){f._moveThumbnailsList(-f.thumbnailsClipper[e]())});this.thumbnailsClipper.css("transform","translateZ(0)")},destroyThumbnails:function(){this.thumbnailsContainer&&this.thumbnailsContainer.remove();this.thumbnails=this.thumbnailsContainer=null},createThumbnails:function(){this.thumbnails||this.initThumbnails();var a,b=this.thumbnailConfig();this.thumbnails=[];for(var c=0,d=this.pages.length;c<d;c++)a=this.createThumbnail(c,
b),this.thumbnailsList.append(a),this.thumbnails.push(a);a=this.thumbnailsContainer;a.width()||a.width(2*b.width)},thumbnailConfig:function(){var a={},b=d('<div class="wowbook-thumbnail" style="display:none;position:absolute;line-height:0px;font-size:0px;">').prependTo(this.thumbnailsContainer),c=this.opts.thumbnailHeight||(2>=b.height()?0:b.height()),f=this.opts.thumbnailWidth||b.width(),e=f/this.pageWidth||c/this.pageHeight||this.opts.thumbnailScale;b.remove();a.width=f||this.pageWidth*e;a.height=
c||this.pageHeight*e;a.cloneCSS={display:"block",left:0,top:0,position:"relative",transformOrigin:"0 0"};d.wowBook.support.transform?a.cloneCSS.transform="scale("+e+")":a.cloneCSS.zoom=e;return a},createThumbnail:function(a,b){var c=this.pages[a];if(c){b||(b=this.thumbnailConfig());var f=d('<li class="wowbook-thumbnail"><div class="wowbook-overlay">').addClass(this.pageIsOnTheLeft(a)?"wowbook-left":"wowbook-right").css({width:b.width,height:b.height});this.opts.thumbnailsSprite?f.css("background",
"url("+this.opts.thumbnailsSprite+") no-repeat 0px -"+a*b.height+"px"):(c=c.clone(),c.hasClass("wowbook-page-holded")&&(this.resetPage(c),c.find(".wowbook-fold-gradient-container").remove()),c.css(b.cloneCSS),f.prepend(c));var e=this;f.click(function(){e.gotoPage(a)});return f}},updateThumbnail:function(a,b){var c=this.thumbnails[a];if(c){var d=this.createThumbnail(a,b);d&&(this.opts.thumbnailsSprite||c.children(":not(.wowbook-overlay)").replaceWith(d.children(":not(.wowbook-overlay)")),c.width(d.width()),
c.height(d.height()))}},updateThumbnails:function(){if(this.thumbnails){for(var a=this.thumbnailConfig(),b=0,c=this.pages.length;b<c;b++)this.updateThumbnail(b,a);b=this.thumbnailsContainer;b.width()||b.width(2*a.width)}else this.createThumbnails()},_moveThumbnailsList:function(a,b){var c=this.thumbnailsList.position()[this.opts.thumbnailsVertical?"top":"left"];this._setThumbnailsListPosition(c+a,b)},_setThumbnailsListPosition:function(a,b){var c=this.opts.thumbnailsVertical,d=c?"height":"width",
e={},g=this.thumbnailsClipper[d](),d=-this.thumbnailsList[d]()+g;a<d&&(a=d);0<a&&(a=0);this.thumbnailsBackButton.toggleClass("wowbook-disabled",0==a||0<d);this.thumbnailsNextButton.toggleClass("wowbook-disabled",a==d||0<d);e[c?"top":"left"]=a;this.thumbnailsList.animate(e,void 0!=b?b:this.opts.thumbnailsAnimOptions)},showThumbnail:function(a,b){if(this.thumbnails&&this.thumbnailsContainer.is(":visible")){void 0==a&&(a=this.currentPage);0<a&&this.pageIsOnTheRight(a)&&a--;var c=this.opts.thumbnailsVertical,
d=c?"top":"left",e=c?"height":"width",g=this.thumbnails[a],h=this.thumbnailsClipper,c=h[e]()/2-g[e]()/(c?2:1),d=g.offset()[d]-h.offset()[d];this._moveThumbnailsList(c-d,b)}},showThumbnails:function(a){this.thumbnails&&this.thumbnails.length||this.createThumbnails();this.thumbnailsContainer.fadeIn(void 0!=a?a:this.opts.thumbnailsAnimOptions);this.showThumbnail(void 0,0)},hideThumbnails:function(a){this.thumbnailsContainer.fadeOut(void 0!=a?a:this.opts.thumbnailsAnimOptions)},toggleThumbnails:function(a){d(this.thumbnailsContainer).is(":visible")?
this.hideThumbnails(a):this.showThumbnails(a)},controllify:function(a){var b=this;d(a.zoomIn).on("click.wowbook",function(){b.zoomIn();return!1});d(a.zoomOut).on("click.wowbook",function(){b.zoomOut();return!1});d(a.next).on("click.wowbook",function(){b.advance();return!1});d(a.back).on("click.wowbook",function(){b.back();return!1});d(a.first).on("click.wowbook",function(){b.gotoPage(0);return!1});d(a.last).on("click.wowbook",function(){b.gotoPage(b.pages.length-1);return!1});d(a.slideShow).on("click.wowbook",
function(){b.toggleSlideShow();return!1});d(a.flipSound).on("click.wowbook",function(){b.toggleFlipSound();return!1});d(a.thumbnails).on("click.wowbook",function(){b.toggleThumbnails();return!1})},toggleControl:function(a,b){(a=this.opts.controls[a])&&d(a).toggleClass("wowbook-disabled",b)}};d.wowBook.defaults={width:500,height:300,startPage:0,hardcovers:!1,hardPages:!1,centeredWhenClosed:!1,transparentPages:!1,responsive:!1,scaleToFit:"",onResize:null,use3d:!0,perspective:2E3,useTranslate3d:"mobile",
bookShadow:!0,gutterShadow:!0,shadowThreshold:20,shadows:!0,foldGradient:!0,foldGradientThreshold:20,pageNumbers:!0,firstPageNumber:1,numberedPages:!1,deepLinking:!0,updateBrowserURL:!0,curl:!0,curlSize:40,slideShow:!1,slideShowDelay:1E3,pauseOnHover:!0,touchEnabled:!0,mouseWheel:!1,handleWidth:!1,handleClickDuration:300,turnPageDuration:1E3,turnPageDurationMin:300,forceBasicPage:!1,sections:".wowbook-section",zoomLevel:1,zoomMax:2,zoomMin:1,zoomBoundingBox:window,zoomStep:0.05,onZoom:null,flipSound:!1,
flipSoundFile:["page-flip.mp3","page-flip.ogg"],flipSoundPath:"wow_book/sound/",onPlayFlipSound:null,keyboardNavigation:{back:37,advance:39},clipBoundaries:!0,controls:{},onShowPage:null,onHoldPage:null,onReleasePage:null,thumbnails:!1,thumbnailsParent:"body",thumbnailScale:0.2,thumbnailWidth:null,thumbnailHeight:null,thumbnailsPosition:null,thumbnailsVertical:!0,thumbnailsContainerWidth:null,thumbnailsContainerHeight:null,thumbnailsSprite:null,thumbnailsAnimOptions:{}};"undefined"!=typeof QUnit&&
(d.wowBook.wowBook=l);window.raf=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();d.browser.ie8mode=d.browser.msie&&8==document.documentMode;var n=d.browser.msie&&9>d.browser.version?1:0,q={thin:2-n,medium:4-n,thick:6-n};d.wowBook.utils={translate:function(a,b,c){return d.wowBook.useTranslate3d?"translate3d("+a+"px, "+b+"px, "+(c||0)+"px) ":"translate("+a+"px, "+b+"px) "},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}})(jQuery);
(function(d){function l(l){var n=l||window.event,q=[].slice.call(arguments,1),a=0,b=0,c=0;l=d.event.fix(n);l.type="mousewheel";n.wheelDelta&&(a=n.wheelDelta/120);n.detail&&(a=-n.detail/3);c=a;void 0!==n.axis&&n.axis===n.HORIZONTAL_AXIS&&(c=0,b=-1*a);void 0!==n.wheelDeltaY&&(c=n.wheelDeltaY/120);void 0!==n.wheelDeltaX&&(b=-1*n.wheelDeltaX/120);q.unshift(l,a,b,c);return(d.event.dispatch||d.event.handle).apply(this,q)}var u=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks)for(var r=u.length;r;)d.event.fixHooks[u[--r]]=
d.event.mouseHooks;d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var d=u.length;d;)this.addEventListener(u[--d],l,!1);else this.onmousewheel=l},teardown:function(){if(this.removeEventListener)for(var d=u.length;d;)this.removeEventListener(u[--d],l,!1);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(d){return d?this.bind("mousewheel",d):this.trigger("mousewheel")},unmousewheel:function(d){return this.unbind("mousewheel",d)}})})(jQuery);
(function(d){function l(l){if(l in u.style)return d.wowBook.support[l]=l;for(var n=r.length,q,a=l.charAt(0).toUpperCase()+l.substr(1);n--;)if(q=r[n]+a,q in u.style)return d.wowBook.support[l]=q}if(d.cssHooks){var u=document.createElement("div"),r=["O","ms","Webkit","Moz"];l("transform");l("transformOrigin");l("boxSizing");l("zoom");d.wowBook.support.boxSizing&&8>document.documentMode&&(d.wowBook.support.boxSizing=!1);u=null;d.each(["transform","transformOrigin"],function(l,n){d.wowBook.support[n]&&
d.wowBook.support[n]!==n&&!d.cssHooks[n]&&(d.cssHooks[n]={get:function(l,a,b){return d.css(l,d.wowBook.support[n])},set:function(l,a){l.style[d.wowBook.support[n]]=a}})});d.wowBook.applyAlphaImageLoader=function(l){var n,q,a,b,c="",f=d("<div style='display:none'></div>").appendTo("body");q=0;for(a=l.length;q<a;q++)if(b=l[q],f.addClass(b),n=f.css("background-image").match(/^url\("(.*)"\)$/))c+="."+b+"{background:none; filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+n[1]+"', sizingMethod='scale'); } ",
f.removeClass(b);d("body").append("<style>"+c+"</style>")}}else alert("jQuery 1.4.3+ is needed for this plugin to work")})(jQuery);
